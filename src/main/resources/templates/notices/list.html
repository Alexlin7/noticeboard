<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="zh-TW">
<head th:replace="~{fragment/head :: basic-header}"></head>
<body>
<header th:replace="~{fragment/header :: navbar}"></header>
<div class="container my-6">
    <h1>公告列表</h1>

    <!-- Success Message -->
    <div th:if="${successMessage}" class="alert alert-success alert-dismissible fade show" role="alert">
        <span th:text="${successMessage}"></span>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>

    <div class="mb-3">
        <a th:href="@{/notices/new}" class="btn btn-primary">新增公告</a>
    </div>

    <table class="table table-striped table-bordered">
        <thead class="table-dark">
        <tr>
            <th>標題</th>
            <th>發佈日期</th>
            <th>截止日期</th>
            <th style="width: 150px;">操作</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="notice : ${noticePage.content}">
            <td>
                <a th:href="@{/notices/{id}(id=${notice.id})}" th:text="${notice.title}">...</a>
            </td>
            <td th:text="${#temporals.format(notice.publicationDate, 'yyyy-MM-dd')}">...</td>
            <td th:text="${#temporals.format(notice.endDate, 'yyyy-MM-dd')}">...</td>
            <td>
                <a th:href="@{/notices/{id}/edit(id=${notice.id})}" class="btn btn-sm btn-warning">修改</a>
                <form th:action="@{/notices/{id}/delete(id=${notice.id})}" method="post" class="d-inline" onsubmit="return confirmDelete(event)">
                    <button type="submit" class="btn btn-sm btn-danger">刪除</button>
                </form>
            </td>
        </tr>
        </tbody>
    </table>

    <!-- Pagination -->
    <nav th:if="${noticePage.totalPages > 1}">
        <ul class="pagination">
            <li class="page-item" th:classappend="${noticePage.first ? 'disabled' : ''}">
                <a class="page-link" th:href="@{/notices(page=${noticePage.number - 1})}">上一頁</a>
            </li>
            <li class="page-item" th:each="i : ${#numbers.sequence(0, noticePage.totalPages - 1)}" th:classappend="${i == noticePage.number ? 'active' : ''}">
                <a class="page-link" th:href="@{/notices(page=${i})}" th:text="${i + 1}"></a>
            </li>
            <li class="page-item" th:classappend="${noticePage.last ? 'disabled' : ''}">
                <a class="page-link" th:href="@{/notices(page=${noticePage.number + 1})}">下一頁</a>
            </li>
        </ul>
    </nav>
</div>

<footer th:replace="~{fragment/footer :: footer}"></footer>

</body>
</html>
